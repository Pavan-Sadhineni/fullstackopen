(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{18:function(e,t,n){e.exports=n(45)},26:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),s=n.n(c),u=n(7),o=n(1),l=n.n(o),i=n(4),m=n(5),p=function(e){var t=e.blog,n=e.onLikeClick,c=e.onRemoveClick,s=e.authUser,u=Object(a.useState)(!1),o=Object(m.a)(u,2),l=o[0],i=o[1];return r.a.createElement("div",{className:"mt-12 blog-list-item"},t.title,", by ",t.author,r.a.createElement("button",{onClick:function(){i(!l)},className:"btn ml-8","data-test-id":"toggleBlog"},l?"Hide":"View"),l&&r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{"data-test-id":"blogDetailsList"},r.a.createElement("li",null,t.url),r.a.createElement("li",null,"Likes ",r.a.createElement("span",{"data-test-id":"blogLikes"},t.likes),r.a.createElement("button",{onClick:n.bind(null,t.id),className:"btn ml-8","data-test-id":"likeBlog"},"Like")),r.a.createElement("li",null,t.user.name)),s.username===t.user.username&&r.a.createElement("button",{onClick:c.bind(null,t.id,t.title,t.author),"data-test-id":"removeBlog",className:"btn mt-12 blog-item-remove-btn"},"Remove")))},f=n(2),b=n.n(f),d=function(e){var t=e.onFormSubmit,n=e.usernameOnchange,a=e.passwordOnchange,c=e.username,s=e.password;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Login to the account!"),r.a.createElement("form",{onSubmit:t},r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"username"},"Username:"),r.a.createElement("input",{type:"text",placeholder:"Enter username",id:"username",onChange:n,className:"input-field",value:c})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",{type:"password",placeholder:"Enter password",id:"password",onChange:a,className:"input-field",password:s})),r.a.createElement("button",{id:"loginButton",className:"btn"},"Login")))};d.prototype={onFormSubmit:b.a.func.isRequired,usernameOnchange:b.a.func.isRequired,passwordOnchange:b.a.func.isRequired,username:b.a.string.isRequired,password:b.a.string.isRequired};var g=d,h=(n(26),function(e){var t=e.message,n=e.type;return r.a.createElement("div",{className:"".concat("unsuccessful"===n?"notification--error":"notification--success"," notification")},t)});h.defaultProps={type:"successful"};var v=h,E=n(6),w=n.n(E),O=null,k=function(e){O="bearer ".concat(e)},y=function(){var e=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.get("/api/blogs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(i.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,w.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(i.a)(l.a.mark((function e(t,n){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:O}},e.next=3,w.a.put("".concat("/api/blogs","/").concat(t),n,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(i.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,w.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(e){var t=e.titleOnchange,n=e.authorOnchange,a=e.urlOnchange,c=e.onFormSubmit,s=e.blogTitle,u=e.blogAuthor,o=e.blogUrl;return r.a.createElement("form",{onSubmit:c},r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"title"},"Title:"),r.a.createElement("input",{type:"text",placeholder:"Enter title of the blog",id:"title",onChange:t,className:"input-field",value:s})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"author"},"Author:"),r.a.createElement("input",{type:"text",placeholder:"Enter author of the blog",id:"author",onChange:n,className:"input-field",value:u})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"url"},"Url:"),r.a.createElement("input",{type:"text",placeholder:"Enter url of the blog",id:"url",onChange:a,className:"input-field",value:o})),r.a.createElement("button",{"data-test-id":"create",className:"btn"},"Create"))};S.prototype={titleOnchange:b.a.func.isRequired,authorOnchange:b.a.func.isRequired,urlOnchange:b.a.func.isRequired,onFormSubmit:b.a.func.isRequired,blogTitle:b.a.string.isRequired,blogAuthor:b.a.string.isRequired,blogUrl:b.a.string.isRequired};var R=S,C=Object(a.forwardRef)((function(e,t){var n=Object(a.useState)(!1),c=Object(m.a)(n,2),s=c[0],u=c[1],o={display:s?"none":""},l={display:s?"":"none"},i=function(){u(!s)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:o},r.a.createElement("button",{onClick:i,className:"btn mt-12"},e.buttonLabel)),r.a.createElement("div",{style:l},e.children,r.a.createElement("button",{onClick:i,className:"btn mt-12"},"Cancel")))}));C.prototype={buttonLabel:b.a.string.isRequired,children:b.a.node},C.displayName="Togglable";var F=C,L=function(){var e=Object(i.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=(n(44),function(){var e=Object(a.useState)([]),t=Object(m.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(""),o=Object(m.a)(s,2),f=o[0],b=o[1],d=Object(a.useState)(""),h=Object(m.a)(d,2),E=h[0],w=h[1],O=Object(a.useState)(null),S=Object(m.a)(O,2),C=S[0],q=S[1],A=Object(a.useState)(""),B=Object(m.a)(A,2),T=B[0],U=B[1],I=Object(a.useState)(""),J=Object(m.a)(I,2),P=J[0],z=J[1],D=Object(a.useState)(""),V=Object(m.a)(D,2),H=V[0],W=V[1],G=Object(a.useState)({}),K=Object(m.a)(G,2),M=K[0],Q=K[1],X=Object(a.useRef)(),Y=function(){var e=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y();case 3:t=e.sent,c(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),Q({message:"Something went wrong",type:"unsuccessful"}),console.warn(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){Y()}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);q(t),k(t.token)}}),[]),Object(a.useEffect)((function(){if(M.message){var e=setTimeout((function(){return Q({})}),4e3);return function(){return clearTimeout(e)}}}),[M]);var Z=function(){if(f&&E)return!0;Q({message:"Please fill both fields.",type:"unsuccessful"})},$=function(){var e=Object(i.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!Z()){e.next=15;break}return e.prev=2,e.next=5,L({username:f,password:E});case 5:n=e.sent,k(n.token),window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(n)),q(n),b(""),w(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),401===e.t0.response.status?Q({message:"Wrong username or password",type:"unsuccessful"}):console.warn(e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}(),_=function(e){w(e.target.value)},ee=function(e){b(e.target.value)},te=function(){window.localStorage.removeItem("loggedBlogAppUser"),q(null)},ne=function(e){U(e.target.value)},ae=function(e){z(e.target.value)},re=function(e){W(e.target.value)},ce=function(){if(T&&P&&H)return!0;Q({message:"Please fill all fields",type:"unsuccessful"})},se=function(){var e=Object(i.a)(l.a.mark((function e(t){var n,a,r,s,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!ce()){e.next=22;break}return n={title:T,author:P,url:H},e.prev=3,e.next=6,x(n);case 6:if(!e.sent){e.next=14;break}return Q({message:"A new blog ".concat(T,", by ").concat(P," added")}),X.current&&X.current.toggleVisibility(),e.next=12,y();case 12:a=e.sent,c(a);case 14:U(""),z(""),W(""),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(3),r=e.t0.response,s=r.data,u=r.statusText,Q({message:s.error||u,type:"unsuccessful"}),console.warn(e.t0);case 22:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=Object(i.a)(l.a.mark((function e(t){var a,r,s,o,i,m,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=n.find((function(e){return e.id===t})))){e.next=16;break}return e.prev=2,r=a.likes?a.likes+1:1,s=Object(u.a)(Object(u.a)({},a),{},{likes:r}),e.next=7,j(t,s);case 7:e.sent&&(o=n.map((function(e){return e.id===t?s:e})),c(o)),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),i=e.t0.response,m=i.data,p=i.statusText,Q({message:m.error||p,type:"unsuccessful"}),console.warn(e.t0);case 16:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(i.a)(l.a.mark((function e(t,a,r){var s,u,o,i,m;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s="Remove blog ".concat(a," by ").concat(r),!window.confirm(s)){e.next=14;break}return e.prev=2,e.next=5,N(t);case 5:u=n.filter((function(e){return e.id!==t})),c(u),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(2),o=e.t0.response,i=o.data,m=o.statusText,Q({message:i.error||m,type:"unsuccessful"}),console.warn(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n,a){return e.apply(this,arguments)}}(),le=function(){return n.length>0&&r.a.createElement("div",{className:"blog-list-wrapper","data-test-id":"blogListWrapper"},n.sort((function(e,t){return t.likes-e.likes})).map((function(e){return r.a.createElement(p,{key:e.id,blog:e,onLikeClick:ue,onRemoveClick:oe,authUser:C})})))};return r.a.createElement(r.a.Fragment,null,M.message&&r.a.createElement(v,{message:M.message,type:M.type}),r.a.createElement("h2",{className:"main-title"},"Blogs"),C&&C.token?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"user-introduction"},r.a.createElement("h3",null,C.name," logged in!"),"\xa0",r.a.createElement("button",{onClick:te,className:"btn","data-test-id":"logout"},"Logout")),r.a.createElement(F,{buttonLabel:"Create new Blog",ref:X},r.a.createElement(R,{titleOnchange:ne,authorOnchange:ae,urlOnchange:re,onFormSubmit:se,blogTitle:T,blogAuthor:P,blogUrl:H})),le()):r.a.createElement(F,{buttonLabel:"Login"},r.a.createElement(g,{onFormSubmit:$,passwordOnchange:_,usernameOnchange:ee,username:f,password:E})))});s.a.render(r.a.createElement(q,null),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.2f8f9473.chunk.js.map